#!/usr/bin/env node

const path = require('path');
const { fetchTokenHoldersSnapshot } = require('../src/fetch-token-holders');

async function main() {
	// Get contract address from command line
	const contractAddress = process.argv[2];
	if (!contractAddress) {
		console.error("❌ Error: Please provide contract address as parameter");
		console.log("Usage: fetch-token <contract_address>");
		process.exit(1);
	}

	// Output directory is fixed to data folder
	const outputDir = path.join(__dirname, '..', 'data');

	try {
		await fetchTokenHoldersSnapshot(contractAddress, outputDir);
	} catch (error) {
		console.error("❌ Fatal error:", error.message);
		process.exit(1);
	}
}

main();
